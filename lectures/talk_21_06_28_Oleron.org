# -*- coding: utf-8 -*-
# -*- mode: org -*-
#+Title:  Reproducibility Crisis and Open Science
#+Author: Arnaud Legrand\medskip\newline\logoInstitutions
#+DATE:  \vspace{3cm}\JDEVlogo \href{https://sigr2020.sciencesconf.org/}{Sciences de l'information géographique reproductibles}\newline June 2021\newline\begin{overlayarea}{1.05\linewidth}{0cm}\vspace{-3.2cm}\hfill{\mylogo}\end{overlayarea}\vspace{-1.0cm}
#+LANGUAGE: en
#+STARTUP: beamer indent inlineimages logdrawer
#+TAGS: noexport(n)

#+PROPERTY: header-args  :session :eval never-export :exports both
#+DRAWERS: latex_headers

:latex_headers:
#+LaTeX_CLASS: beamer
#+LATEX_CLASS_OPTIONS: [10pt,presentation,xcolor={usenames,dvipsnames,svgnames,table}]
# # aspectratio=169
#+OPTIONS:   H:2 num:t toc:nil \n:nil @:t ::t |:t ^:nil -:t f:t *:t <:t
#+LATEX_COMPILER: lualatex -shell-escape
#+LATEX_HEADER: \usedescriptionitemofwidthas{bl}
#+LATEX_HEADER: \usepackage[T1]{fontenc}
#+LATEX_HEADER: \usepackage[utf8]{inputenc}
#+LATEX_HEADER: \usepackage{figlatex}
#+LATEX_HEADER: \usepackage[french]{babel}
#+LATEX_HEADER: %\usepackage{DejaVuSansMono}
#+LATEX_HEADER: \usepackage{ifthen,amsmath,amstext,gensymb,amssymb}
#+LATEX_HEADER: \usepackage{relsize}
#+LATEX_HEADER: \usepackage{boxedminipage,xspace,multicol}
#+LATEX_HEADER: %%%%%%%%% Begin of Beamer Layout %%%%%%%%%%%%%
#+LATEX_HEADER: \ProcessOptionsBeamer
#+LATEX_HEADER: \usetheme[numbering=fraction,titleformat=smallcaps,progressbar=frametitle]{metropolis}
#+LATEX_HEADER: \usepackage{fontawesome}
#+LATEX_HEADER: \usecolortheme[named=BrickRed]{structure}
#+LATEX_HEADER: %%%%%%%%% End of Beamer Layout %%%%%%%%%%%%%
#+LATEX_HEADER: \usepackage{array}
#+LATEX_HEADER: \newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
#+LATEX_HEADER: \newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
#+LATEX_HEADER: \newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}

#+LATEX_HEADER: \usepackage{verbments}
#+LATEX_HEADER: \usepackage{xcolor}
#+LATEX_HEADER: \usepackage{color}
#+LATEX_HEADER: \usepackage{url} \urlstyle{sf}
#+LATEX_HEADER: \let\alert=\structure % to make sure the org * * works of tools
#+LATEX_HEADER: %\let\tmptableofcontents=\tableofcontents
#+LATEX_HEADER: %\def\tableofcontents{}
#+LATEX_HEADER: \let\hrefold=\href
#+LATEX_HEADER: \usepackage{ifluatex}
#+LATEX_HEADER: \ifpdftex
#+LATEX_HEADER:   \usepackage[normalem]{ulem}\usepackage{soul}
#+LATEX_HEADER:   % \usepackage{color}
#+LATEX_HEADER:   \definecolor{lightorange}{rgb}{1,.9,.7}
#+LATEX_HEADER:   \sethlcolor{lightorange}
#+LATEX_HEADER:   \definecolor{lightgreen}{rgb}{.7,.9,.7}
#+LATEX_HEADER:   \makeatother
#+LATEX_HEADER:      \renewcommand{\href}[2]{\hrefold{#1}{\SoulColor{lightorange}\hl{#2}}}
#+LATEX_HEADER:      % \renewcommand{\uline}[1]{\SoulColor{lightorange}\hl{#1}}
#+LATEX_HEADER:      % \renewcommand{\emph}[1]{\SoulColor{lightorange}\hl{#1}}
#+LATEX_HEADER:   \makeatletter
#+LATEX_HEADER:   \newcommand\SoulColor[1]{%
#+LATEX_HEADER:   \sethlcolor{#1}%
#+LATEX_HEADER:   \let\set@color\beamerorig@set@color%
#+LATEX_HEADER:   \let\reset@color\beamerorig@reset@color}
#+LATEX_HEADER: \else
#+LATEX_HEADER:    \usepackage[soul]{lua-ul}
#+LATEX_HEADER:    \usepackage{tcolorbox}
#+LATEX_HEADER:      \renewcommand{\href}[2]{\hrefold{#1}{\begin{tcolorbox}[colback=orange!30!white,size=minimal,hbox,on line]{#2}\end{tcolorbox}}}
#+LATEX_HEADER:      \let\textttold=\texttt
#+LATEX_HEADER:      \renewcommand\texttt[1]{\begin{tcolorbox}[colback=green!30!white,size=minimal,hbox,on line]{\smaller\textttold{#1}}\end{tcolorbox}}
#+LATEX_HEADER: \fi
#+LATEX_HEADER: % 
#+LATEX_HEADER: % \renewcommand\alert[1]{\SoulColor{lightgreen}\hl{#1}}
#+LATEX_HEADER: % \AtBeginSection{\begin{frame}{Outline}\tableofcontents\end{frame}}
#+LATEX_HEADER: \usepackage[export]{adjustbox}
#+LATEX_HEADER: \graphicspath{{fig/}}
#+LATEX_HEADER: \usepackage{tikzsymbols}
#+LATEX_HEADER: \def\smiley{\Smiley[1][green!80!white]}
#+LATEX_HEADER: \def\frowny{\Sadey[1][red!80!white]}
#+LATEX_HEADER: \def\winkey{\Winkey[1][yellow]}
#+LATEX_HEADER: \def\JDEVlogo{}%\includegraphics[height=1cm]{./images/jdevLogo.pdf}}
#+LATEX_HEADER: \def\mylogo{\includegraphics[height=2.5cm]{./images/in_science_we_trust.jpg}}
#+LATEX_HEADER: \def\logoInstitutions{\includegraphics[height=.7cm]{./images/Logo-UGA2020.pdf}\quad\includegraphics[height=.7cm]{./images/Logo-CNRS.pdf}\quad\includegraphics[height=.7cm]{./images/Logo-Inria.pdf}\includegraphics[height=.7cm]{./images/Logo-Lig.pdf}\vspace{-.7cm}}
#+LATEX_HEADER: %\usepackage{pgf}  
#+LATEX_HEADER: %\logo{\pgfputat{\pgfxy(-2,6.5)}{\pgfbox[center,base]{\includegraphics[height=1cm]{./images/jdevLogo.pdf}}}}

#+LaTeX: \newsavebox{\temp}

#+BEGIN_EXPORT latex
  \newcommand{\myfbox}[2][gray!20]{\bgroup\scalebox{.7}{\colorbox{#1}{{\vphantom{pS}#2}}}\egroup} % \fbox
  %\def\myfbox#1{#1} % \fbox
  \def\HPC{\myfbox[gray!40]{HPC}}
  \def\NET{\myfbox[gray!40]{Network}}
  \def\SG{\myfbox[gray!40]{Smart Grids}}
  \def\ECO{\myfbox[gray!40]{Economics}}
  \def\PRIV{\myfbox[gray!40]{Privacy}}
  \def\TRACING{\myfbox[red!20]{Tracing}}
  \def\SIM{\myfbox[green!20]{Simulation}}
  \def\VIZ{\myfbox[red!40]{Visualization}}
  \def\MODELING{\myfbox[green!40]{Stochastic Models}}
  \def\OPT{\myfbox[blue!20]{Optimization}}
  \def\GT{\myfbox[blue!40]{Game Theory}}
#+END_EXPORT

#+BEGIN_EXPORT latex
\def\etal{\textit{et al.}\xspace}
\def\eg{e.g.,\xspace}
#+END_EXPORT

#+BEGIN_EXPORT latex
\def\changefont#1{%
  \setbeamertemplate{itemize/enumerate body begin}{#1}
  \setbeamertemplate{itemize/enumerate subbody begin}{#1}
  #1}
\makeatletter
\newcommand{\verbatimfont}[1]{\renewcommand{\verbatim@font}{\ttfamily#1}}
\makeatother
\verbatimfont{\scriptsize}%small
\let\endmintedbak=\endminted
\def\endminted{\endmintedbak\vspace{-1cm}}

\def\rv#1{\ensuremath{\textcolor{blue}{#1}}\xspace} % DarkBlue
#+END_EXPORT

#+BEGIN_EXPORT latex
\newcommand{\Norm}{\ensuremath{\mathcal{N}}\xspace}
\newcommand{\Unif}{\ensuremath{\mathcal{U}}\xspace}
\newcommand{\Triang}{\ensuremath{\mathcal{T}}\xspace}
\newcommand{\Exp}{\ensuremath{\mathcal{E}}\xspace}
\newcommand{\Bernouilli}{\ensuremath{\mathcal{B}}\xspace}
\newcommand{\Like}{\ensuremath{\mathcal{L}}\xspace}
\newcommand{\Model}{\ensuremath{\mathcal{M}}\xspace}
\newcommand{\E}{\ensuremath{\mathbb{E}}\xspace}
\def\T{\ensuremath{\theta}\xspace}
\def\Th{\ensuremath{\hat{\theta}}\xspace}
\def\Tt{\ensuremath{\tilde{\theta}}\xspace}
\def\Y{\ensuremath{y}\xspace}
\def\Yh{\ensuremath{\hat{y}}\xspace}
\def\Yt{\ensuremath{\tilde{y}}\xspace}
\let\epsilon=\varepsilon
\let\leq=\leqslant
\let\geq=\geqslant

\def\Scalebox#1{\scalebox{.9}{#1}}
\def\ScaleboxI#1{\Scalebox{\textit{#1}}}

\def\pillar#1#2{~\hbox{\hspace{-1em}\rlap{#1}\hspace{4cm}\includegraphics[height=1cm]{#2}}}
#+END_EXPORT
:end:

** Public Evidence for a Lack of Reproducibility
\small
#+LaTeX: \vspace{-.3cm}\hspace{-.1\linewidth}\begin{overlayarea}{1.1\linewidth}{8cm}
#+LaTeX:   \begin{overlayarea}{\linewidth}{0cm}
#+LaTeX:    \vspace{1.4cm}~\hspace{.05\linewidth}\includegraphics[width=\linewidth]{images/reproducibility_crisis_headlines.pdf}
#+LaTeX:   \end{overlayarea}
- J.P. Ioannidis. /[[http://www.plosmedicine.org/article/info:doi/10.1371/journal.pmed.0020124][Why Most Published Research Findings Are False]]/
  PLoS Med. 2005.
- /[[http://mescal.imag.fr/membres/arnaud.legrand/teaching/2011/EP_lies.pdf][Lies, Damned Lies, and Medical Science]]/, The Atlantic. Nov, 2010
- /[[http://www.nature.com/news/reproducibility-a-tragedy-of-errors-1.19264][Reproducibility: A tragedy of errors]]/, Nature, Feb 2016.
- Steen RG, /[[http://dx.doi.org/10.1136/jme.2010.040923][Retractions in the scientific literature: is the incidence
  of research]] \newline [[http://dx.doi.org/10.1136/jme.2010.040923][fraud increasing?]]/, J. Med. Ethics 37, 2011
#+LaTeX: \end{overlayarea}
#+LaTeX: \vspace{-.5cm}~\begin{flushright}\scriptsize \bf Courtesy V. Stodden, SC, 2015\hspace{.35\linewidth}\null\end{flushright}
** Newsworthy Stories about Scientific Misconduct
#+LaTeX: \hbox{\hspace{-.08\linewidth}\begin{overlayarea}{1.15\linewidth}{8cm}\vspace{-.3cm}\small

- [[https://en.wikipedia.org/wiki/Dong-Pyou_Han][Dong-Pyou Han]] :: Assistant professor, Biomedical
   sciences, Iowa State University, 2013\footnotesize

  /*Falsified blood results* to make it appear as though a vaccine exhibited anti-HIV activity/
  - Han and his team received
    #+LaTeX: $\approx \$19$ million from NIH
  - _*1 retracted publication*_ and *resignation* of university. Sentenced
    in 2015 to *57 months imprisonment* for fabricating and falsifying
    data in HIV vaccine trials.
    #+LaTeX: \alert{$\$7.2$ million!}\pause
  \normalsize
- [[https://en.wikipedia.org/wiki/Diederik_Stapel][Diederik Stapel]] :: Professor, Social Psychology, Univ. Tilburg, 2011
  # https://en.wikipedia.org/wiki/Diederik_Stapel#Scientific_misconduct
  # - /Carnivores are more selfish than vegetarians/, 
  #+BEGIN_QUOTE
  \footnotesize
  I failed as a scientist. I *adapted research data* and *fabricated
  research*. Not once, but *several times*, not for a short period, but
  *over a longer period of time*. [..] I am aware of the suffering and
  sorrow that I caused to my colleagues... I *did not withstand the pressure
  to score, to publish, the pressure to get better in time*. I wanted
  too much, too fast. In a system where there are few checks and
  balances, where people work alone, I took the wrong turn. \hfill _*58 retracted publications*_\pause
  #+END_QUOTE
- [[https://en.wikipedia.org/wiki/Brian_Wansink][Brian Wansink]] :: Professor, Psychological Nutrition, Cornell, 2016
  # https://blogs.sciencemag.org/pipeline/archives/2018/02/26/gotta-be-a-conclusion-in-here-somewhere
  # - /Mindless Eating/, /Obesity/, /Attractive names sustain increased vegetable intake in schools/
  #+BEGIN_QUOTE
  \footnotesize 
  *I gave her a data set of a self-funded, failed study
  which had null results*. I said "This cost us a lot of time and our
  own money to collect. *There's got to be something here we can
  salvage because it's a cool (rich & unique) data set*." I told her
  what the analyses should be.
  [..] Every day she came back with puzzling new results, and *every
  day we would scratch our heads*, ask "Why," *and come up with another
  way to reanalyze the data* with yet another set of plausible
  hypotheses\hfill _*17 retracted publications*_
  #+END_QUOTE
#+LaTeX: \end{overlayarea}}
** Scientific Misconduct? What are the consequences ?
\small
- [[https://en.wikipedia.org/wiki/Growth_in_a_Time_of_Debt][Reinhart and Rogoff]] :: Professors of Economics at Harvard
  
  #+BEGIN_QUOTE
  \footnotesize gross debt [..] exceeding 90 percent of the economy
  has a significant negative effect on economic growth \hfill /--
  Growth in a Time of Debt (2010)/ \smallskip

  While using RR's working spreadsheet, we identified *coding
  errors*, *selective exclusion* of available data, and *unconventional*
  weighting of summary *statistics*.
  \hfill /-- 2013: Herndon, Ash and Pollin/ \smallskip

  For 3 years, austerity was not presented as an option but as a
  necessity.   \newline\null\hfill /-- 2013: Paul_Krugman/ \vspace{-1em}
  #+END_QUOTE
  At least, a scientific debate has been possible.

\pause
*Bad science is \textbf{deleterious}*
- It is used to backup stupid politics, it affects people’s life, ...
- It blurs the frontier between scientists and crooks
\bigskip

Media attention *inflates \textbf{conspiracy} opinions* $\frowny$
\footnotesize\em
  - Scientific result are worthless.
  - Scientists can't even agree with each others on \rlap{economy/climate/vaccine/5G/...}
  - Stop the scientific dictatorship/lobby! 
** A Credibility Crisis?                                          :noexport:
*** Fraud is not new                                             :BMCOL:
:PROPERTIES:
:BEAMER_col: .55
:END:
Scientific misconduct is obviously wrong but it's *not new*!
- \footnotesize Every domain has its black sheep
- \footnotesize The publish or perish pressure is a pain
*** Famous scientists                                               :BMCOL:
:PROPERTIES:
:BEAMER_col: .4
:END:
\small
[[http://www.cnrs.fr/fr/pdf/cim/CIM36.pdf][/The Battle against
Scientific Fraud/]]
CNRS International Magazine

#+LaTeX:  \centerline{\includegraphics[width=.5\linewidth]{images/CNRS_CIM_36_scientists.pdf}}

*** back to Normal :B_ignoreheading:
:PROPERTIES:
:BEAMER_env: ignoreheading
:END:
\pause
# \vspace{-.3cm}

\hspace{-.5cm}Fraud is the (*uninteresting*) visible part of the iceberg
*** Biomedical Fraud                                                :BMCOL:
:PROPERTIES:
:BEAMER_col: .18
:END:
#+LaTeX: \includegraphics[height=4.6cm]{images/CNRS_CIM_36_biomed_fraud.png}
*** Errors?!?                                                      :BMCOL:
:PROPERTIES:
:BEAMER_col: .48
:END:
- \bgroup\bf *Failing to reproduce* the results of others is common\egroup
  \newline\bgroup\footnotesize /[[http://www.nature.com/news/1-500-scientists-lift-the-lid-on-reproducibility-1.19970][1,500 scientists lift the lid on
  reproducibility]]/, Nature, May 2016\egroup
- How so? *Why now*? *Why is this important*? What can we do about it?
*** Lift the lid                                                    :BMCOL:
:PROPERTIES:
:BEAMER_col: .2
:END:
#+LaTeX: \hbox{\hspace{-1cm}\includegraphics[height=4.6cm]{images/reproducibility-graphic-online2.jpg}}

** A Credibility Crisis?
How so? *Why now*? *Why is this important*? What can we do about it?
\vspace{-1.7em}
#+BEGIN_CENTER
   [[http://www.cnrs.fr/fr/pdf/cim/CIM36.pdf][/The Battle against Scientific Fraud/ in the CNRS International
   Magazine]]
#+END_CENTER
#+BEGIN_EXPORT latex
\vspace{-.2em}
\begin{columns}
  \begin{column}{.4\linewidth}
    \includegraphics[width=.9\linewidth]{images/CNRS_CIM_36_biomed_fraud.png}
  \end{column}
  \begin{column}{.6\linewidth}
    
    \begin{center}
      \includegraphics[width=.6\linewidth]{images/CNRS_CIM_36_scientists.pdf}
    \end{center}
    \vspace{-1em}
#+END_EXPORT
\small \textbf{Galileo} (data fabrication), \textbf{Ptolemy} (plagiarism),
\textbf{Mendel} (data enhancement), [[http://lascienceenfraude.blogspot.fr/2012/05/limposture-de-pasteur.html][\bf Pasteur]] (rigorous but hid
failures), ...
#+BEGIN_EXPORT latex
    \end{column}
  \end{columns}
#+END_EXPORT
Scientific misconduct is obviously wrong but it's *not new*!
- \footnotesize Every domain has its black sheep \hfill
  \alert{\textbullet} The publish or perish pressure is a pain
** A Reproducibility Crisis?
#+BEGIN_EXPORT latex
\vspace{-.3cm}
\null\hspace{-.2cm}\hbox{
\begin{columns}
  \begin{column}{.4\linewidth}
    \begin{overlayarea}{\linewidth}{8cm}
      \includegraphics[scale=.2]{images/reproducibility-graphic-online2.jpg}\\
      \includegraphics[scale=.2]{images/reproducibility-graphic-online3.jpg}
      % \includegraphics<3>[scale=.25]{images/reproducibility-graphic-online4.jpg}%
      % \includegraphics<4>[scale=.25]{images/reproducibility-graphic-online5.jpg}
    \end{overlayarea}
  \end{column}\hspace{-.2cm}%
  \begin{column}{.66\linewidth}\begin{overlayarea}{\linewidth}{8cm}\vspace{-.7em}
#+END_EXPORT
\small
[[http://www.nature.com/news/1-500-scientists-lift-the-lid-on-reproducibility-1.19970][1,500 scientists lift the lid on reproducibility]], Nature, May 2016

\normalsize _*Social causes*_ \small
- \footnotesize Fraud, conflict of interest (pharmaceutic, \dots)
- \footnotesize  *No incentive* to reproduce/check our own work (afap), nor the
  work of others (big results!), nor to allow others to check
  (competition)
- \footnotesize  Peer review does not scale: 1+ million articles per year!
\normalsize _*Methodological or technical causes*_ 
- \footnotesize The many biases (apophenia, confirmation, hindsight,
  experimenter, ...): *bad designs*
- \footnotesize Selective reporting, weak analysis (*statistics*, *data manipulation
  mistakes*, *computational errors*)
- \footnotesize  *Lack of information, code/raw data unavailable*  
#+BEGIN_EXPORT latex
    \end{overlayarea}
  \end{column}
\end{columns}}
#+END_EXPORT
** Reproducibility of experimental results is the /hallmark of science/ :noexport:
#+BEGIN_EXPORT latex
\vspace{-.4em}
\begin{tabular}{@{\hspace{-1em}}c@{\hspace{-1em}}c@{\hspace{-.6em}}c@{}}
\includegraphics[height=3.4cm]{images/Newton.jpg}&
\begin{minipage}[b]{.75\linewidth}
  \begin{quote}
    What Descartes did was a good step. You have added much several ways [..]
    If I have seen further it is by standing on the shoulders of Giants.

    \hfill -- \textbf{Isaac Newton}, February \alert{1676}
  \end{quote}
  \begin{center}
    \uncover<2->{In a letter to his rival Robert Hooke} \medskip

    Science discovers truth by building on previous discoveries
  \end{center}
\end{minipage}&
\includegraphics[height=3.4cm]{images/Hooke.jpg}
\end{tabular}\hspace{-1em}%
#+END_EXPORT

\pause

*1662:* \textbf{Robert Hooke}, Curator of Experiments for the Royal Society, coins
the term */experimentum crucis/*.
#+BEGIN_CENTER
Only good experiments allow to build sound theories and refute bad
ones\medskip
#+END_CENTER
\pause

#+LaTeX: \begin{columns}
#+LaTeX:   \begin{column}[t]{.77\linewidth}
*1934*: \textbf{Karl Popper} puts the notions of *falsifiability* and
*crucial experiment* as the *hallmark of science*
#+LaTeX:   \end{column}\begin{column}[t]{.2\linewidth}
#+begin_export latex
\includegraphics[height=1.9cm,valign=t]{images/karl_popper1.png}%
\includegraphics[height=1.9cm,valign=t]{images/karl_popper2.png}
#+end_export
#+LaTeX:   \end{column}
#+LaTeX: \end{columns}

# #+BEGIN_QUOTE
# Reproducibility of experimental results is the hallmark of science\vspace{-.6em}
# \flushright [[[http://www.site.uottawa.ca/ICML09WS/papers/w2.pdf][Drummond, 2009]]]
# #+END_QUOTE
** \Scalebox{Reproducibility of experimental results: the }\ScaleboxI{hallmark of science}
:PROPERTIES:
:BEAMER_OPT: fragile
:END:
\small
*** Popper                          :B_ignoreheading:
:PROPERTIES:
:BEAMER_env: ignoreheading
:END:

#+begin_export latex
\begin{overlayarea}{\linewidth}{0cm}
  \hbox{%
    \hspace{.8\linewidth}
    \includegraphics[height=1.9cm,valign=t]{images/karl_popper1.png}%
    \includegraphics[height=1.9cm,valign=t]{images/karl_popper2.png}
  }
\end{overlayarea}
#+end_export
*1934*: \textbf{Karl Popper} puts the notions of *falsifiability* and\newline
*crucial experiment* as the *hallmark of science*
\small
- If no experiment can be set up to *disprove* your \newline theory, it
  is not science
- Good experiments *discriminate good theories from bad ones*
- *Non-reproducible* single occurrences are of no significance to
  science
  # #+BEGIN_QUOTE
  #   If you claim to have spotted a flying saucer but nobody else can
  #   confirm this observation, then it does not count as a scientific
  #   evidence.
  # #+END_QUOTE
*** Popper                                                 :noexport:BMCOL:
:PROPERTIES:
:BEAMER_col: .77
:BEAMER_OPT: t
:END:
*1934*: \textbf{Karl Popper} puts the notions of *falsifiability* and
*crucial experiment* as the *hallmark of science*
\small
- If no experiment can be set up to *disprove* your theory, it is not
  science
- Good experiments *discriminate good theories from bad ones*
- *Non-reproducible* single occurrences are of no significance to
  science
  # #+BEGIN_QUOTE
  #   If you claim to have spotted a flying saucer but nobody else can
  #   confirm this observation, then it does not count as a scientific
  #   evidence.
  # #+END_QUOTE
*** Picture                                                :noexport:BMCOL:
:PROPERTIES:
:BEAMER_col: .2
:BEAMER_OPT: t
:END:
#+begin_export latex
\includegraphics[height=1.9cm,valign=t]{images/karl_popper1.png}%
\includegraphics[height=1.9cm,valign=t]{images/karl_popper2.png}
#+end_export
*** An ideal rather than the norm                          :B_ignoreheading:
:PROPERTIES:
:BEAMER_env: ignoreheading
:END:
\bigskip\pause

\textbf{An ideal rather than the norm}

Popper's proposal works well for Physics from the 18th century but is
not so simple for many other domains:

\vspace{-5mm}
*** Examples                                                        :BMCOL:
:PROPERTIES:
:BEAMER_col: .37
:BEAMER_OPT: t
:END:
- Theory of evolution
- Spotting a SuperNova
- Particle Physics \small(a single LHC)\normalsize
*** Examples                                                         :BMCOL:
:PROPERTIES:
:BEAMER_col: .63
:BEAMER_OPT: t
:END:
- Biology (every animal does not behave in the same way)
- Anthropology (impact on people from a remote culture)
** Reproducibility: a /core value of science/
1. _Universality_: Science aims for *objective findings*, *accessible to
   anyone*
   #+BEGIN_CENTER
   *Reproducibility* acts as a *Universality/Robustness control*\bigskip
   #+END_CENTER
2. _Incremental_: We build on each others work but everybody makes
   mistakes
   
   \small Methods, biases, ... How to discriminate sound +theories+ experiments
   from bad ones?\normalsize  $\winkey$
   #+BEGIN_CENTER
   *Reproducibility* acts as a *Quality control*   
   #+END_CENTER
\bigskip\pause

*** Practices have evolved                                          :BMCOL:
:PROPERTIES:
:BEAMER_col: .7
:Beamer_opt: t
:END:
But, *scientific practices have greatly evolved*, in particular
since we rely on *computers*

\vspace{1.3cm}

[[https://theconversation.com/how-computers-broke-science-and-what-we-can-do-to-fix-it-49938][How computers broke science -- and what we can do about it]] 

\hfill -- Ben Marwick, The conversation, 2015
*** Computer pic                                                    :BMCOL:
:PROPERTIES:
:BEAMER_col: .3
:Beamer_opt: t
:END:
#+LaTeX: \hfill\includegraphics[width=\linewidth,valign=t]{images/computer_broke_science.jpg}
** How computers broke science
#+LaTeX: \hbox{\hspace{-.05\linewidth}\begin{overlayarea}{1.1\linewidth}{8cm}\vspace{-.3cm}\small

# https://theconversation.com/how-computers-broke-science-and-what-we-can-do-to-fix-it-49938
#+BEGIN_EXPORT latex
  \begin{columns}
    \begin{column}[b]{.2\linewidth}
       \vspace{1mm}
       \includegraphics[width=1.4\linewidth]{images/Chang_proteins.png}
    \end{column}\hfill
    \begin{column}[b]{.8\linewidth}
#+END_EXPORT
*Geoffrey Chang* (Scripps, UCSD) works on crystalography and studies the
structure of cell membrane proteins. \medskip

\small He specialized in structures of *multidrug resistant transporter
proteins in bacteria*: MsbA de Escheria Choli (Science, 2001), Vibrio
cholera (Mol. Biology, 2003), Salmonella typhimurium (Science, 2005)
\bigskip
#+BEGIN_EXPORT latex
    \end{column}
  \end{columns}\vspace{-3mm}
#+END_EXPORT

*2006*: Inconsistencies reveal [[https://people.ligo-wa.caltech.edu/~michael.landry/calibration/S5/getsignright.pdf][a programming mistake]] \newline\vspace{-1em}
   #+BEGIN_QUOTE
   A homemade data-analysis program had flipped two columns of data,
   inverting the electron-density map from which his team had derived
   the protein structure.\vspace{-2mm}
   #+END_QUOTE
_*5 retractations*_ that motivate *improved software engineering
practices* in comp. biology\medskip\pause

\bgroup\bf There is *worse*!\egroup\vspace{-.5em}
- The generalized and intensive use of [[https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-1044-7][*spreadsheets*]] ([[https://www.theguardian.com/politics/2020/oct/05/how-excel-may-have-caused-loss-of-16000-covid-tests-in-england][COVID tracing]])
- Relying on *black box* statistical methods is infinitely easier than
  understanding them \hfill (Learning and Data Analytics frameworks = nuke)
- *Numerical errors* and *software environment* unawareness
#+latex: \end{overlayarea}}
** Different Reproducibility Concerns in Modern Science
# _Distinguish between:_
# #+LaTeX: \begin{columns}\begin{column}[b]{.4\linewidth}
# - experimental science
# - observational science
# #+LaTeX: \end{column}\begin{column}[b]{.6\linewidth}
# - computational science (simulation)
# - (big) data analysis
# #+LaTeX: \end{column}\end{columns}%\bigskip
\small
- Social Sciences, Oncology, ... :: methodology, statistics, pre-registration
- Genomics :: software engineering, computational reproducibility,
  provenance
- Computational fluid dynamics :: numerical issues\medskip

\vspace{-1em}
/The processing steps between raw observations and findings have gotten
increasingly numerous and complex/
#+BEGIN_EXPORT latex
\begin{center}
  \includegraphics<+>[width=.88\linewidth]{images/iceberg_publication-1.png}%
  \includegraphics<+>[width=.88\linewidth]{images/iceberg_publication-2.png}%
  \includegraphics<+>[width=.88\linewidth]{images/iceberg_publication-3.png}%
  \includegraphics<+>[width=.88\linewidth]{images/iceberg_publication-4.png}%
  \includegraphics<+->[width=.88\linewidth]{images/iceberg_publication-5.png}\medskip
  
  \uncover<+>{\normalsize\bf Reproducible Research = Bridging the Gap by working Transparently}
\end{center}
#+END_EXPORT
** Modern Science                                                 :noexport:
The processing steps between raw observations and findings have gotten
increasingly numerous and complex.

#+BEGIN_EXPORT latex
\begin{center}
  \includegraphics<+>[width=.7\linewidth]{images/iceberg_publication-1.png}%
  \includegraphics<+>[width=.7\linewidth]{images/iceberg_publication-2.png}%
  \includegraphics<+>[width=.7\linewidth]{images/iceberg_publication-3.png}%
  \includegraphics<+>[width=.7\linewidth]{images/iceberg_publication-4.png}%
  \includegraphics<+->[width=.7\linewidth]{images/iceberg_publication-5.png}\medskip
  
  \uncover<+>{\bf Reproducible Research = Bridging the Gap by working Transparently}
\end{center}
#+END_EXPORT
** Different (but Converging) Reproducibility Concerns            :noexport:
Reproducibility/robustness of the scientific fact, the statistical
analysis, the computation, the observation, the process, \dots ?\pause

Bad computer/statistic/publication practices "broke science"
$\winkey$
#+BEGIN_EXPORT latex
\vspace{-3em}
\begin{overlayarea}{\linewidth}{0cm}
  \vspace{-3em}
  \begin{flushright}
    \includegraphics[height=4cm]{images/iceberg.jpg}
  \end{flushright}
\end{overlayarea}
#+END_EXPORT
- Ensure articles and data are *available*
  - *Open Access*, *Open Data*, FAIR and DMP\pause
- /Ensure/ the *experiment design* and *analysis* is not broken
  - +data torture and hacking+, *pre-registration*, education, ...\pause
- Explain *how* the computations unfold and *why*
  - *Notebooks* (that can quickly get out of control)
  - Simple computational *workflows*\pause
- Allow to _*inspect*_, _*rerun*_, _*make variations*_ on computations
  - Access to code, data, ... \pause *options/parameters*, *environment*, *resources*?\medskip
  This requires *first class software engineering practices* instead of
  building on prototypes
  #+BEGIN_CENTER
  Software factories, Archives, and Provenance Tracking tools
  #+END_CENTER
  
* Reproducible Research Practices
** "Reproducible Research": First Appearance
*Claerbout & Karrenbach*, 
\scalebox{.75}{meeting of the Society of Exploration Geophysics}, 1992

file:images/clearbout.pdf
** Reproducibility, Replicability, Robustness, Generalization
#+LaTeX: \centering\includegraphics[width=\linewidth]{images/reproducible_replicable_etc.jpg}
** Reproducibility (glossary may vary)
:PROPERTIES:
:BEAMER_OPT: fragile
:END:
#+latex: \small
#+latex: \def\alert#1{\structure{\textbf{#1}}}

Many [[https://en.wikipedia.org/wiki/Reproducibility][definitions]] (/replicability, repeatability, reproducbility/),
#+latex: \hbox{sometimes conflicting\hspace{-1cm}}\\
\phantom{Many definitions }(/new data,     same person, independant researcher/)

#+ATTR_LATEX: :align C{2.5cm}C{4.5cm}@{$\quad \to\quad$}c
| *experimental* reproducibility  | similar input (data) +\newline similar experimental protocol                          | *similar results*\footnote{Up-to measurement variability and precision}                    |
|-------------------------------+---------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------|
| *statistical* reproducibility   | same input (data) +\newline same analysis                                             | *same conclusions*\footnote{Independently from (random) sampling variability (fight bias)} |
|-------------------------------+---------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------|
| *computational* reproducibility | similar input (data) +\newline same code/software +\newline same software environment | *exact same results*\footnote{Bitwise}                                                     |

\bigskip

#+begin_quote
\bf 
Reproducible Research = A way of doing science so that scientific
experiments, discoveries, results, etc. can be easily reproduced (done
again), to be confirmed, or to be built on for the next study.
#+end_quote
\vspace{1cm}

#+latex: \let\alert=\structure % Restore

** Existing Tools, Emerging Standards
\vspace{1em}
#+LaTeX: \begin{columns}\begin{column}[t]{.4\linewidth}\centering
\bf *Notebooks and workflows*

file:images/jupyterpreview.png

#+LaTeX: \includegraphics[height=.8cm]{images/logo/Jupyter_logo.png}
#+LaTeX: \includegraphics[height=.8cm]{images/logo/OrgMode_logo.png}
#+LaTeX: \includegraphics[height=.8cm]{images/logo/RStudio_logo.png}
file:images/logo/workflows.png

#+LaTeX: \end{column}\begin{column}[t]{.35\linewidth}\centering
\bf *Software environments*

file:images/python3-matplotlib.pdf 
#+ATTR_LaTeX: :width .6\linewidth
file:images/platform_diversity.png

#+LaTeX: \includegraphics[height=1cm]{images/logo/docker_logo.png}
#+LaTeX: \includegraphics[height=1cm]{images/logo/singularity_logo.png}
#+LaTeX: \includegraphics[height=.8cm]{images/logo/reprozip.png}
#+LaTeX: \includegraphics[height=1cm]{images/logo/Guix_logo.png}
#+LaTeX: \includegraphics[height=1cm]{images/logo/nix_logo.png}

#+LaTeX: \end{column}\begin{column}[t]{.35\linewidth}\centering
\bf *Sharing platforms*\bigskip

#+LaTeX: \includegraphics[height=1cm]{images/logo/git_logo.png}
#+LaTeX: \includegraphics[height=1cm]{images/logo/github_logo.png}
#+LaTeX: \includegraphics[height=1cm]{images/logo/gitlab_logo.png}
#+LaTeX: \includegraphics[height=1cm]{images/logo/JupyterHub_logo.png}
#+LaTeX: \includegraphics[height=1cm]{images/logo/ArXiv-web.png}
#+LaTeX: \includegraphics[height=1cm]{images/logo/LogoHAL.png}
#+LaTeX: \includegraphics[height=1cm]{images/logo/Figshare-logo.png}
#+LaTeX: \includegraphics[height=1cm]{images/logo/Zenodo-logo.jpg}
#+LaTeX: \includegraphics[height=1cm]{images/logo/swh-logo.png}

#+LaTeX: \end{column}\end{columns}\bigskip



# - Provenance, mise à disposition, software environment capture,
#   literate programming, etc. Still no perfect solution but much better
#   tools.
#   - notebooks: jupyter/...
#   - containers/... 
#   - github/gitlab/zenodo/swh... to
#   - execution in the cloud: continuous integration and codeocean
* Good Practice #1\newline Taking Notes and Documenting
** Frustration as an Author/Reviewer
:PROPERTIES:
:BEAMER_OPT: fragile
:END:
# , shrink=1

#+begin_export latex
\begin{overlayarea}{\linewidth}{0cm}
  \vspace{-1.9cm}
  \hbox{\hspace{.89\linewidth}\includegraphics[height=2cm]{images/fuuu_plz.png}\hspace{-4cm}}
\end{overlayarea}
\vspace{-.4cm}
#+end_export

\small
*** Enlarge frame                                         :B_ignoreheading:
:PROPERTIES:
:BEAMER_env: ignoreheading
:END:
#+latex: \hbox{\hspace{-.05\linewidth}\begin{overlayarea}{1.1\linewidth}{8cm}
*** Author
- I thought I used the same parameters but *I'm getting different results*!
- The new student wants to compare with *the method I proposed last year*
- My advisor asked me whether I took care of setting this or this but
  *I can't remember*
- The damned fourth reviewer asked for a major revision and wants me
   to *change Figure 3*. *Which code and which data set did I use?*
- *It worked yesterday!*  6 months later: *Why did I do that?*
*** Reviewer
- As usual, there is *no confidence interval*, I wonder about the
  variability and whether the difference is *significant* or not
- That can't be true, I'm sure *they removed some points*
- Why is this graph in logscale? *How would it look like otherwise?*
  *I'm not even sure* of what this value means. If only I could access
  the generation script
*** Enlarge frame                                         :B_ignoreheading:
:PROPERTIES:
:BEAMER_env: ignoreheading
:END:
#+latex: \end{overlayarea}}
** Tool 1: Computational Notebooks/Litterate Programming
#+LaTeX: \includegraphics<+>[width=\linewidth]{images/example_pi_full-1.pdf}%
#+LaTeX: \includegraphics<+>[width=\linewidth]{images/example_pi_full-2.pdf}%
#+LaTeX: \includegraphics<+>[width=\linewidth]{images/example_pi_full-3.pdf}%
#+LaTeX: \includegraphics<+>[width=\linewidth]{images/example_pi_full-4.pdf}%
#+LaTeX: \includegraphics<+>[width=\linewidth]{images/example_pi_full-5.pdf}%
#+LaTeX: \includegraphics<+->[width=\linewidth]{images/example_pi_full-6.pdf}%

#+BEGIN_EXPORT latex
\begin{overlayarea}{\linewidth}{0cm}
%  \vspace{-1.8cm}
  \vspace{-1cm}
  \begin{center}
    \includegraphics<+>[height=.8cm]{images/logo/Jupyter_logo.png}
    \includegraphics<.>[height=.8cm]{images/logo/OrgMode_logo.png}
    \includegraphics<.>[height=.8cm]{images/logo/RStudio_logo.png}
 %    \only<.>{\href{https://jupyterhub.u-ga.fr/}{https://jupyterhub.u-ga.fr/}}
  \end{center}
\end{overlayarea}
#+END_EXPORT

*** Export svg pdf                                               :noexport:
#+begin_src shell :results output :exports both
for i in images/example_pi_*.svg ; do
   inkscape $i --export-pdf=`dirname $i`/`basename $i .svg`.pdf;
done
#+end_src

#+RESULTS:
** Journal and Reproducible Article Demo
Document your:
- *Hypotheses*: keep track of your ideas/line of thoughts
- *Experiments*: details on how and why an experiment was run, including
  failed or ambiguous attempts
- *Initial analysis or interpretation of these experiments*: was the
  outcome conform to the expectation or not? does it (in)validate the
  hypothesis? *why* did you do this or that ?
- *Organization*: keep track of things to do/fix/test/improve
\textbf{Write for the future you}
  
I have a very intense usage of my journal and I can *demo this today*
- Experiment results are better *structured by dates* (*add tags*)
- Final rendering of results (figures, tables, article, presentation)
  should be reproducible
- Use plain text and lightweight markup languages (e.g., LaTeX or Markdown)
** Tool 1 bis: Workflows
#+latex: \only<1-4>{
Notebooks are no panacea and do not help developing clean code
#+latex: }

#+LaTeX: \includegraphics<+>[height=6cm]{images/mooc/nb1.png}%
#+LaTeX: \includegraphics<+>[height=6cm]{images/mooc/nb2.png}%
#+LaTeX: \includegraphics<+>[height=6cm]{images/mooc/nb3.png}%
#+LaTeX: \includegraphics<+>[height=6cm]{images/mooc/nb4.png}%
#+LaTeX: \vspace{.8cm}\only<+>{\begin{overlayarea}{1.5\linewidth}{8cm}
#+ATTR_LATEX: :height 7cm :center nil
file:images/mooc/SbmlParameterisation.png
#+ATTR_LATEX: :height 7cm :center nil
file:images/mooc/SbmlModelling.png
#+LaTeX: \end{overlayarea}}\only<+>{}\vspace{1cm}

*Workflows*:
- Clearer high-level view
- Composition of codes and data movement made explicit
- Safer sharing, reusing, and execution
- Notebooks are a variant that is both impoverished and richer
- No simple/mature path from a notebook to a workflow

*Examples*:
- Galaxy, Kepler, Taverna, Pegasus, Collective Knowledge, VisTrails
- Light-weight: dask, drake, swift, snakemake, ...
- Hybrids: SOS-notebook, ...

* Good Practice #2\newline \hbox{Controling Software Environment}
** Argh... damned computers
- \textbf{Alice}: I got 3.123123 \hspace{2cm} \textbf{Bob}: I got segfault
- Damned! It used to work!!! Whenever I upgrade my computer, things
  break so I try to stay away from this $\frowny$
- Anyway, I don’t have the root password \hfill The what?...
- Whenever trying the code of my colleague, I had to install Foo but
  I broke everything and now neither his code nor mine works! $\frowny$
- But hey! Here is my code, feel free to play with it! I’m doing open
  science \winkey
#+begin_center
Seriously ? How come all this is so painful ?
#+end_center
** Backwards compatibility
*** Examples                                                        :BMCOL:
:PROPERTIES:
:BEAMER_col: .6
:END:
\small
#+ATTR_BEAMER: :overlay <+->
- Software environment evolution
- Software evolution and OS heterogeneity
- Impact of the compiler
#+LaTeX: \vspace{-.1cm}
****                                          :B_exampleblock:
:PROPERTIES:
:BEAMER_env: exampleblock
:END:
#+LaTeX: \begin{overlayarea}{\linewidth}{5cm}\scriptsize
  #+LaTeX: \only<1>{\vspace{-2cm}
    #+ATTR_LATEX: :height 2.35cm :center nil
    file:images/plot_1.5.3.png
    #+ATTR_LATEX: :height 2.35cm :center nil
    file:images/plot_2.1.1.png
  #+LaTeX: }%
  #+LaTeX: \only<2>{
    The Effects of FreeSurfer Version, Workstation Type, and Macintosh
    Operating System Version on Anatomical Volume and Cortical Thickness
    Measurements (PLOS ONE, 2012)
  
    #+BEGIN_QUOTE
    Significant differences in volume and cortical thickness were
    revealed *across FreeSurfer versions*. In addition, less pronounced
    differences were found *between* the *Mac* and *HP workstations* and
    *between Mac OSX 10.5 and OSX 10.6*.
    #+END_QUOTE
  #+LaTeX: }%
  #+LaTeX: \only<3->{
    Assessing Reproducibility: An Astrophysical Example of
    Computational Uncertainty in the HPC Context (ResCuE-HPC, 2018)

      #+LaTeX: \null\hbox{\hspace{-.4cm}\scalebox{.87}{
      #+ATTR_LATEX: :center nil
      | Compiler     | Optim. | Largest Halo |          | Walltime |
      |              |        |    Avg Mass. | Std. Err |          |
      |--------------+--------+--------------+----------+----------|
      | gcc@6.2.0    | None   |     2.273E46 | 1.069E44 | 22h      |
      | gcc@6.2.0    | Normal |     2.266E46 | 1.218E44 | 10h      |
      | gcc@6.2.0    | High   |     2.275E46 | 1.199E44 | 9h       |
      |--------------+--------+--------------+----------+----------|
      | intel@16.0.3 | None   |     2.271E45 | 1.587E44 | 39h      |
      | intel@16.0.3 | Normal |    *4.330(45)* | 1.248E44 | 7h       |
      | intel@16.0.3 | High   |     2.268E46 | 1.414E44 | 6h       |
      |--------------+--------+--------------+----------+----------|
      | cce@8.5.5    | Low    |    *4.311(45)* | 1.353E44 | 16h      |
      | cce@8.5.5    | Normal |     2.271E46 | 1.261E44 | 6h       |
      | cce@8.5.5    | High   |     2.272E46 | 1.341E44 | 5h       |
      # |--------------+--------+--------------+----------+----------|
      # | pgi@16.9.0   | Normal |     2.272E46 | 1.326E44 | 13h      |
      # | pgi@16.9.0   | High   |     2.271E46 | 1.191E44 | 10h      |
      #+LaTeX: }}
    #+LaTeX: }
#+LaTeX: \end{overlayarea}
*** Reproducibility Challenge                                       :BMCOL:
:PROPERTIES:
:BEAMER_col: .4
:BEAMER_act: <4->
:END:

#+LaTeX: \begin{overlayarea}{\linewidth}{0cm}\vspace{3cm}
#+LaTeX: \includegraphics<3>[width=\linewidth]{images/rescueHPC_gal1.png}%
#+LaTeX: \includegraphics<4>[width=\linewidth]{images/rescueHPC_gal2.png}%
#+LaTeX: \end{overlayarea}

#+LaTeX: \uncover<5->{
#+ATTR_LaTeX: :width \linewidth
file:images/ten-years-challenge.png

#+LaTeX: \resizebox{\linewidth}{!}{
[[http://rescience.github.io/ten-years/][http://rescience.github.io/ten-years/]]
#+LaTeX: }
#+LaTeX: }
** Complex ecosystems

#+begin_src python :results output :exports both
import matplotlib
print(matplotlib.__version__) 
#+end_src

#+RESULTS:
: 3.1.2

\vspace{-3mm}\pause
#+name: python3_apt
#+begin_src shell :results output :exports both
apt show python3-matplotlib
#+end_src

#+RESULTS: python3_apt
#+begin_example
Package: python3-matplotlib
Version: 3.1.2-2
Priority: optional
Section: python
Source: matplotlib
Maintainer: Sandro Tosi <morph@debian.org>
Installed-Size: 15.3 MB
Depends: python3-dateutil, python-matplotlib-data (>= 3.1.2-2), python3-pyparsing (>= 1.5.6), python3-six (>= 1.4), libjs-jquery, libjs-jquery-ui, python3-numpy (>= 1:1.16.0~rc1), python3-numpy-abi9, python3 (<< 3.9), python3 (>= 3.7~), python3-cycler (>= 0.10.0), python3-kiwisolver, python3:any, libc6 (>= 2.29), libfreetype6 (>= 2.2.1), libgcc-s1 (>= 3.0), libpng16-16 (>= 1.6.2-1), libstdc++6 (>= 5.2)
Recommends: python3-pil, python3-tk
Suggests: dvipng, ffmpeg, gir1.2-gtk-3.0, ghostscript, inkscape, ipython3, librsvg2-common, python-matplotlib-doc, python3-cairocffi, python3-gi, python3-gi-cairo, python3-gobject, python3-nose, python3-pyqt5, python3-scipy, python3-sip, python3-tornado, texlive-extra-utils, texlive-latex-extra, ttf-staypuft
Enhances: ipython3
Homepage: http://matplotlib.org/
Download-Size: 5387 kB
APT-Manual-Installed: no
APT-Sources: http://ftp.fr.debian.org/debian testing/main amd64 Packages
Description: Python based plotting system in a style similar to Matlab (Python 3)
 Matplotlib is a pure Python plotting library designed to bring
 publication quality plotting to Python with a syntax familiar to
 Matlab users. All of the plotting commands in the pylab interface can
 be accessed either via a functional interface familiar to Matlab
 users or an object oriented interface familiar to Python users.
 .
 This package contains the Python 3 version of matplotlib.
#+end_example

#+BEGIN_EXPORT latex
\begin{overlayarea}{\linewidth}{5cm}
  \pause\vspace{-10.5cm}\includegraphics<+>[width=1.15\linewidth]{images/python3-matplotlib.png}%
\end{overlayarea}
#+END_EXPORT
** Non standard ecosystems :B_frame:
:PROPERTIES:
:BEAMER_env: frame
:BEAMER_opt: shrink=10
:END:

- No standard ::  
  - Linux (=apt=, =rpm=, =yum=), MacOS X (=brew=, =MacPorts=, =Fink=), Windows (?)
  - Neither for installation nor for retrieving the information... $\frowny$

#+LaTeX: \vspace{-1.5em}
*** Python                                                          :BMCOL:
:PROPERTIES:
:BEAMER_col: .45
:BEAMER_opt: t
:END:

#+name: python_version
#+begin_src python :results output :exports both
import sys
print(sys.version)
import matplotlib
print(matplotlib.__version__)
import pandas as pd
print(pd.__version__)
#+end_src

#+LaTeX:\begin{lrbox}{\temp}\begin{minipage}{2\linewidth}
#+RESULTS: python_version
: 3.7.6 (default, Jan 19 2020, 22:34:52) 
: [GCC 9.2.1 20200117]
: 3.1.2
: 0.25.3
#+LaTeX: \end{minipage}\end{lrbox}\vspace{.6em}\scalebox{.8}{\usebox{\temp}}  
*** R                                                               :BMCOL:
:PROPERTIES:
:BEAMER_col: .55
:BEAMER_opt: t
:END:
#+begin_src R :results output :session *R* :exports both
library(ggplot2)
sessionInfo()
#+end_src

#+LaTeX:\begin{lrbox}{\temp}\begin{minipage}{2\linewidth}
#+RESULTS:
#+begin_example
R version 3.6.3 RC (2020-02-21 r77847)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Debian GNU/Linux bullseye/sid

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/atlas/libblas.so.3.10.3
LAPACK: /usr/lib/x86_64-linux-gnu/atlas/liblapack.so.3.10.3

locale:
[1] C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] ggplot2_3.2.1

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.3       withr_2.1.2      crayon_1.3.4     dplyr_0.8.4     
 [5] assertthat_0.2.1 grid_3.6.3       R6_2.4.1         lifecycle_0.1.0 
 [9] gtable_0.3.0     magrittr_1.5     scales_1.1.0     pillar_1.4.3    
[13] rlang_0.4.4      lazyeval_0.2.2   glue_1.3.1       purrr_0.3.3     
[17] munsell_0.5.0    compiler_3.6.3   pkgconfig_2.0.3  colorspace_1.4-1
[21] tidyselect_1.0.0 tibble_2.1.3
#+end_example
#+LaTeX: \end{minipage}\end{lrbox}\vspace{.6em}\scalebox{.8}{\usebox{\temp}}  
** Argh... damned computers
\small
- Whenever I upgrade my computer, things break so I try to stay away
  from this  $\frowny$
- Whenever trying the code of my colleague, I had to install Foo but
  I broke everything and now neither his code nor mine works! $\frowny$
- But hey! Here is my code, feel free to play with it! I'm doing open
  science $\winkey$\bigskip

  Are you really aware of your dependencies ?
  - No one will ever run/use your code if it isn't easy to install
  - No one will ever manage to run your code if you don't document how
    to run it
  - Others (even you) are unlikely to get the same results unless you
    automate the execution
** Tool 2: Containers and Package Managers
#+ATTR_LATEX: :align C{3cm}C{3cm}C{3cm}
| The good                                                                                                      | The bad                                                                                                                        | The uggly                                               |
| \includegraphics[height=1cm]{images/logo/Guix_logo.png}\includegraphics[height=1cm]{images/logo/nix_logo.png} | \includegraphics[height=1cm]{images/logo/docker_logo.png} \includegraphics[height=1cm]{images/logo/singularity_logo.png}\qquad | \includegraphics[height=.8cm]{images/logo/reprozip.png} |
*** Automatic tracking\pause
*** Containers
- *Pros*: \quad Lightweight, \quad Good isolation, \quad Easy to use
   #+latex: \only<2>{
  - Running as easy as =docker run <img> <cmd>=
  - Building images: =docker build -f <Dockerfile>=
  - Sharing through the [[https://hub.docker.com/][Docker Hub]]: =docker pull/push <img>=
  #+latex: }\pause
- *Cons*: \quad Opaque, \quad Container build is generally not reproducible
  #+latex: \begin{block}{}<3>\vspace{-1.2cm}
  #+latex: \hspace{.8cm}\begin{overlayarea}{.8\linewidth}{4cm}
  - Recipes rarely follow /reproducible good practices/\vspace{-.2cm}
    #+begin_src shell :results output :exports both
    FROM ubuntu:20.04
    RUN apt-get update
         && apt-get upgrade -y
         && apt-get install -y ...
    #+end_src
    #+latex: \vspace{.2cm}
    + Choose a stable image (and the smallest possible)
    + Include only the necessary libraries (e.g. no graphics libs)
    + Avoid system updates (instead freeze sources)
  #+latex: \end{overlayarea}
  #+latex: \end{block}
  \pause
#+latex: \vspace{-4cm}  
*** Package managers
- Language specific:
  #+latex: \hbox{
    =pip/pipenv/virtualenv=, =conda,= =CRAN/Bioconductor=
  #+latex: \hspace{-3cm}}
  - *Limits*:
    #+latex: \hbox{version management, durability, permeable, language centric\hspace{-1cm}}
- *GUIX/NiX* = Full-fledged functional package manager
  - Native support for environment (/à la git/)
  - Isolation through =--pure=
  - Recompile from source (cache recommended)
    
# #+LaTeX: \begin{center}
# #+LaTeX: \includegraphics[height=1cm]{images/logo/Guix_logo.png}
# #+LaTeX: \includegraphics[height=1cm]{images/logo/nix_logo.png}
# #+LaTeX: \includegraphics[height=1cm]{images/logo/docker_logo.png}
# #+LaTeX: \includegraphics[height=1cm]{images/logo/singularity_logo.png}\qquad
# #+LaTeX: \includegraphics[height=.8cm]{images/logo/reprozip.png} \qquad
# #+LaTeX: \end{center}
* Good Practice #3\newline Version Control and Archiving
** FAIR principles
#+begin_center
#+latex: \includegraphics[width=.8\linewidth]{images/logo/FAIR_data_principles.jpg}

[[https://www.go-fair.org/fair-principles/][https://www.go-fair.org/fair-principles/]]
#+end_center


- "/Open as much as possible and close as much as necessary/" \medskip
- Management, publication, annotation (metadata), archiving \medskip
- Source code = specific data with specific consideration \medskip

Let's go beyond general principles!
** Tool 3: Version Control and Forge
\small
\vspace{-.7cm}
*** Git = version control
\vspace{-.2cm}
****                                                               :BMCOL:
:PROPERTIES:
:BEAMER_col: .5
:END:
- Developed in 2005 by Linus Torvalds for the kernel development
- Local and efficient rollbacks
- Distributed: everyone has a full copy of the history
****                                                               :BMCOL:
:PROPERTIES:
:BEAMER_col: .5
:END:
\vspace{-.3cm}
#+latex:  \includegraphics[height=3.8cm]{images/mooc/git_tree.png}%
*** GitHub, GitLab, and Co
- Free hosting of public projects, social network
- Web interfaces (browsing, preview, online editing)
- User management (read/write, public/private)
- Issues, Continuous Integration, ...

#+begin_export latex
\begin{overlayarea}{\linewidth}{0cm}
  \vspace{-.7cm}
  \hbox{\includegraphics[height=1.3cm]{images/mooc/github_interactions.pdf}%
        \includegraphics[height=1.4cm]{images/mooc/gitlab_interactions.pdf}}
\end{overlayarea}\vspace{-1\baselineskip}
#+end_export

** Tool 3bis: Fighting Information Loss with Archives
\small

#+LaTeX: \hfill \raisebox{-1ex}{\includegraphics[height=.8cm]{images/logo/git_logo.png}}
#+LaTeX: \raisebox{-.5ex}{\includegraphics[height=.8cm]{images/logo/github_logo.png}} or
#+LaTeX: \raisebox{-1.4ex}{\includegraphics[height=.8cm]{images/logo/gitlab_logo.png}}
$=$ awesome collaborations ($\ne$ archive)\hfill\null

- D. Spinellis. /[[https://www.spinellis.gr/sw/url-decay/][The Decay and Failures of URL References]]/. CACM, 46(1),
  2003
    
  #+BEGIN_QUOTE
    The half-life of a referenced URL is approximately 4 years from its
    publication date.
  #+END_QUOTE
- P. Habibzadeh. /[[https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3885908/][Decay of References to Web sites in Articles
 Published in]]/ /[[https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3885908/][General Medical Journals: Mainstream vs Small
 Journals]]/. Applied Clinical Informatics. 4 (4), 2013
 #+BEGIN_QUOTE
    half life ranged from 2.2 years in EMHJ to 5.3 years in BMJ
 #+END_QUOTE
- Discontinuated forges: Code Space, Gitorious, Google code, Inria Gforge
\normalsize\pause
- Article archives :: 
  #+LaTeX: \raisebox{-1.5ex}{\includegraphics[height=.8cm]{images/logo/ArXiv-web.png}}
  #+LaTeX: \raisebox{-1.5ex}{\includegraphics[height=.8cm]{images/logo/LogoHAL.png}}
  #+LaTeX: \hfill\raisebox{-3em}{\includegraphics[height=1.8cm]{images/logo/Internet-archive.png}}\vspace{-2em}
- Data archives ::
  #+LaTeX: \raisebox{-1.5ex}{\includegraphics[height=.8cm]{images/logo/Figshare-logo.png}}
  #+LaTeX: \raisebox{-1.5ex}{\includegraphics[height=.8cm]{images/logo/Zenodo-logo.jpg}}

- Software Archive ::
  #+LaTeX: \raisebox{-2.4ex}{\includegraphics[height=1cm]{images/logo/swh-logo.png}} 
  Collect/Preserve/Share
* What about Computer Science ?                                    :noexport:
** All this is about Computational Sciences. Should we care ?
_Computer Science_ is young and inherits from _Mathematics_, _Engineering_,
_Nat. Sciences_, _Linguistic_, \dots\bigskip

Purely theoretical scientists whose practice is close to mathematics
/may/ not be concerned (can't publish a math article without
releasing the proofs).
- Have a look at [[http://www.math.ias.edu/vladimir/files/2014_IAS.pdf][talk by Vladimir Voevodsky in 2014 at Princeton]] \winkey\pause

\bigskip
#+BEGIN_QUOTE
Computer science is not more related to computers than Astronomy to
telescopes\vspace{-.6em}
\flushright              -- Dijkstra (mis-attributed)
#+END_QUOTE

Right, why should we care about computers? They are *deterministic*
machines after all, right?  \winkey \medskip

\textbf{Model $\neq$ Reality}. Although designed and built by human
beings, computer systems are *so complex* that mistakes easily slip
in...
** Experimenting with computers
#+BEGIN_EXPORT latex
\begin{tabular}{@{\hspace{-1em}}cc@{\hspace{-1em}}}
  \alert{Machines are \uline{real}!} & 
  \alert{Machines are \uline{complicated}} \vspace{.2cm}\\
  {\parbox{.5\linewidth}{\includegraphics[width=\linewidth]{images/shouting_in_the_data_center.jpg}}} &
 % \begin{overlayarea}{.5\linewidth}{1cm}
   {\parbox{.5\linewidth}{\vspace{-1cm}\includegraphics[width=\linewidth]{images/asplos09-producing-data_fig1.pdf}}}
 % \end{overlayarea}
\\
  \scalebox{.9}{\small \href{https://www.youtube.com/watch?v=tDacjrSCeq4}{Brendan Gregg: Shouting in the data center}}
  &\begin{minipage}{.5\linewidth}\small
#+END_EXPORT

  \vspace{-.7cm}Mytkowicz et al. /[[http://doi.acm.org/10.1145/1508284.1508275][Producing wrong data]] [[http://doi.acm.org/10.1145/1508284.1508275][without doing
  anything obviously wrong]]!/ ACM SIGPLAN Not. 44(3), March 2009

#+BEGIN_EXPORT latex
  \end{minipage}
\end{tabular}\medskip
#+END_EXPORT

*Our reality evolves!!!* The hardware keeps evolving so most results on
old platforms quickly become obsolete (although, we keep building on
such results \winkey).

\bf We need to regularly revisit and allow others to build on our work!
 
** Computer performance ? Well, I design algorithms!
\small
- "Real" problems are all NP-hard, Log-APX, etc.

- Real workload = +NP-completeness proof widgets+, regularities and
  properties (difficult to formally state but that should be exploited)

Algorithms are evaluated on particular *workloads* that impact \\
both their running time and the quality of the solutions\bigskip\pause 

*Image Processing*: [[http://mescal.imag.fr/membres/arnaud.legrand/research/meinhardt_canum2016.pdf][True horror stories]], E. Meinhardt-Llopis, CANUM 2016
#+LaTeX: \begin{columns}\begin{column}{.6\linewidth}
- /The proposed multigrid algorithm converges to the solution of the
  problem in O(N)/ using biharmonic functions
- Surprisingly, our naive multi-scale Gauss-Seidel converges much
  faster\pause
#+LaTeX: \end{column}\begin{column}{.4\linewidth}
  #+LaTeX: \includegraphics[width=\linewidth]{images/meinhardt_canum2016_workload.pdf}
#+LaTeX: \end{column}\end{columns}
  
** I design Machine Learning Algorithms

#+LaTeX: \begin{flushright}\vspace{-1cm}\includegraphics[width=.13\linewidth]{images/Sandy-Pentland.jpg}\end{flushright}\vspace{-1cm}

*Machine Learning*:  [[http://www.economist.com/news/briefing/21588057-scientists-think-science-self-correcting-alarming-degree-it-not-trouble][Trouble at the lab]], The Economist 2013

  #+BEGIN_QUOTE
    According to some estimates, three-quarters of published scientific
    papers in the field of machine learning are bunk because of this
    "overfitting". \hfill -- Sandy Pentland (MIT)
  #+END_QUOTE

Every month in CACM, there is an article about the ethical
consequences of Machine Learning on:
- Car driving, Autonomous guns, Law enforcement (risk assessment, predictive
  policing), ...
  #+BEGIN_CENTER
  [[http://dx.doi.org/10.1145/3022181][It's Not the Algorithm, It's the Data]] (CACM, Feb. 2017)
  #+END_CENTER
- Advertising, Loan attribution, Selection at University, Organ
  transplant

#+BEGIN_CENTER
\bf Increasing society concern about *fairness* and *transparency*
#+END_CENTER

** All I care about is the algorithm output (FP)
#+ATTR_LATEX: :width .8\linewidth
file:images/polynome1.pdf
#+begin_src python :results output :exports both
def polynome(x):
    return x**9 - 9.*x**8 + 36.*x**7 - 84.*x**6 + 126.*x**5 \
           - 126.*x**4 + 84.*x**3 - 36.*x**2 + 9.*x - 1.
#+end_src
** Floating-point arithmetic
#+ATTR_LATEX: :width .8\linewidth
file:images/polynome2.pdf
#+begin_src python :results output :exports both
def horner(x):
    return x*(x*(x*(x*(x*(x*(x*(x*(x - 9.) + 36.) - 84.) + 126.) \
           - 126.) + 84.) - 36.) + 9.) - 1.
#+end_src
** Floating-point arithmetic
#+ATTR_LATEX: :width .8\linewidth
file:images/polynome3.pdf
#+begin_src python :results output :exports both
def simple(x):
    return (x-1.)**9
# Easy! ;)
#+end_src
** Floating-point arithmetic
#+ATTR_LATEX: :width .8\linewidth
file:images/polynome3-4.pdf
\vspace{5cm}
** Floating-point arithmetic
#+ATTR_LATEX: :width .8\linewidth
file:images/polynome4.pdf
\vspace{5cm}
** Rounding
#+LaTeX: \def\round{\texttt{round}}
- Every operation includes implicit rounding.
- a+b is actually \round(a+b).
- Unfortunately:
  #+BEGIN_CENTER
  \small
  \round(\round(a+b)+c) $\ne$ \round(a+\round(b+c)).  
  #+END_CENTER
- Operation order therefore matters.

*For a reproducible computation, operation order must be preserved!!!*
** How to explain it to my compiler?
To speed up computations, compilers may change operation order, and thus results.
 
Two options for computing reproducibly:

1. Insist on the preservation of operation order, 
   - if the language permits it.
   - Example: Module `ieee_arithmetic` in Fortran 2003
2. Make compilation reproducible:
   - Record the precise compiler version
   - Record all compilation options
** Did I mention we have \textbf{parallel} machines nowadays?
#+BEGIN_EXPORT latex
\begin{overlayarea}{\linewidth}{7cm}
  \begin{center}
    \includegraphics<+>[width=.9\linewidth, page=13]{pdf_sources/langlois.pdf}%
    \includegraphics<+>[width=.9\linewidth, page=14]{pdf_sources/langlois.pdf}%
    \includegraphics<+>[width=.9\linewidth, page=15]{pdf_sources/langlois.pdf}%
    \includegraphics<+>[width=.9\linewidth, page=16]{pdf_sources/langlois.pdf}%
    \includegraphics<+>[width=.9\linewidth, page=17]{pdf_sources/langlois.pdf}%
    \includegraphics<+>[width=.9\linewidth, page=18]{pdf_sources/langlois.pdf}%
    \includegraphics<+>[width=.9\linewidth, page=19]{pdf_sources/langlois.pdf}%
    \includegraphics<+>[width=.9\linewidth, page=20]{pdf_sources/langlois.pdf}%
    \includegraphics<+>[width=.9\linewidth, page=21]{pdf_sources/langlois.pdf}%
    \includegraphics<+>[width=.9\linewidth, page=22]{pdf_sources/langlois.pdf}%
    \includegraphics<+>[width=.9\linewidth, page=23]{pdf_sources/langlois.pdf}%
    \includegraphics<+>[width=.9\linewidth, page=24]{pdf_sources/langlois.pdf}%
    \includegraphics<+>[width=.9\linewidth, page=25]{pdf_sources/langlois.pdf}%
    \includegraphics<+>[width=.9\linewidth, page=26]{pdf_sources/langlois.pdf}%
    \includegraphics<+>[width=.9\linewidth, page=27]{pdf_sources/langlois.pdf}%
    \includegraphics<+>[width=.9\linewidth, page=28]{pdf_sources/langlois.pdf}%
    \only<+>{
      \begin{flushright}
        \includegraphics[height=4cm]{images/langlois_malpasset.png}\vspace{-3cm}
      \end{flushright}\bigskip
      \begin{flushleft}
        These numerical issues can become \\ quite harmful in real use
        cases.
        \vspace{.5cm}
        
        \small TABLE 1.1: Reproducibility failure of the Malpasset test case
      \end{flushleft}\small
      \begin{tabular}{c|c|c|c}
        & The sequential run & a 64 procs run & a 128 procs run \\\hline
        depth H & 0.3500122E-01 & 0.2\alert{748817}E-01 & 0.\alert{1327634}E-01 \\\hline
        velocity U & 0.4029747E-02 & 0.4\alert{935279}E-02 & 0.4\alert{512116}E-02 \\\hline
        velocity V & 0.7570773E-02 & 0.\alert{3422730}E-02 & 0.75\alert{45233}E-02
      \end{tabular}}
  \end{center}
  \only<.>{
  {\bf \alert{Numerical reproducibility?}}: Approximations in the model, in
  the algorithm, in its implementation, in its execution. \medskip

  The whole chain needs to be revisited.}
\end{overlayarea}
\begin{flushright}\scriptsize Courtesy of P. Langlois and R. Nheili\end{flushright}
#+END_EXPORT
* Toward Reproducible Computer Science Experiments ?               :noexport:
** Key Concerns for our Community (Room for Improvement)
#+LaTeX: \vspace{.3cm}

#+LaTeX: \hbox{\hspace{-.05\linewidth}\begin{minipage}{1.1\linewidth}
\small
/[[https://research.spec.org/fileadmin/user_upload/documents/rg_cloud/endorsed_publications/SPEC_RG_2019_Methodological_Principles_for_Reproducible_Performance_Evaluation_in_Cloud_Computing.pdf][How are cloud performance currently obtained and reported?]]/, 
\bgroup\scriptsize\bf
\textit{Methodological Principles for Reproducible Performance Evaluation in Cloud Computing}, IEEE Trans. on Soft. Eng., July 2019\egroup
#+LaTeX: \end{minipage}}
    # 98 articles, 2012-2017
    #+ATTR_LaTeX: :width .8\linewidth
    file:images/SPEC_RG_2019_Fig4_2.pdf
    # - P2: Workload and configuration coverage discusses whether
    #   experiments are conducted in different (possibly randomized)
    #   configurations of relevant parameters, especially parameters
    #   that are not completely under control or those that may interact
    #   with the platform in unexpected ways, e.g., the workload. P2
    #   shows that less than 47% of the analyzed papers include a
    #   complete performance evaluation with multiple
    #   configurations. Varying configurations can be challenging in
    #   some scenarios, due to timing, cost of cloud service, and other
    #   factors. However, from a scientific perspective, different
    #   configurations may significantly impact the overall performance
    #   and more extensive evaluations are needed. Parameter values
    #   should be randomized according to realistic probabilistic
    #   distributions or using historical data. The confidence in the
    #   final result should be quantified.
    # - P3 discusses the experimental setup description. Even though
    #   more than 52% of the analyzed papers fully cover this principle,
    #   a substantial number of papers do not or only partially describe
    #   the experimental setup in which the performance evaluation is
    #   conducted. This significantly impacts the technical
    #   reproducibility of the results.
    # - P4 partly complements P3, as it considers the accessibility of
    #   the datasets used in the analysis and whether the authors have
    #   released the source code. In more than 70% of the cases, the
    #   code of the assessed technique is not released and the datasets
    #   used for the evaluation are not publicly available.
    # - P6 analyzes if a statistical evaluation has been performed, to
    #   include some (statistical) confidence in the results. This
    #   principle is the most disregarded by the papers we study, with N
    #   > 90%.
#+BEGIN_EXPORT latex
\pause%
\begin{overlayarea}{\linewidth}{0cm}
  \vspace{-6cm}\hspace{2cm}%
  \rotatebox{30}{\fboxsep=0pt
     \fbox{\colorbox{lightgray}{\bf Bad experimental design, statistics, and reporting
    $\frowny$ }}}
\end{overlayarea}\vspace{-.7cm}
#+END_EXPORT



\textbf{Key DoE principles}: 
1. _Replicate_ to *increase reliability*.
2. _Randomize_ to *reduce bias* $\leadsto$ _Evaluate_ *statistical
                  confidence*.
** Measuring performance is difficult
/[[http://doi.acm.org/10.1145/1508284.1508275][Producing wrong data without doing anything obviously wrong]]!/
 \bgroup\footnotesize\bf Mytkowicz et al. in ACM SIGPLAN Not. 44(3), March 2009\egroup
#+LaTeX: \begin{columns}\begin{column}{.58\linewidth}
  \small\it
  changing the size of *environment variables* can trigger performance
  degradation as high as *300%*; simply changing the *link order* of object
  files can cause performance to decrease by as much as *57%*.
#+LaTeX: \end{column}\hspace{-1cm}\begin{column}{.4\linewidth}\vspace{-.7em}
  #+LaTeX: \includegraphics[width=\linewidth]{images/asplos09-producing-data_fig1.pdf}
#+LaTeX: \end{column}\end{columns}\medskip\pause

\bgroup\bf *Taming the Influence of Memory Layout*.\egroup 
/[[http://www.cs.umass.edu/~emery/pubs/stabilizer-asplos13.pdf][\textsc{Stabilizer}: Statistically Sound Performance Evaluation]],/
\bgroup\footnotesize\bf C. Curtsinger and E. Berger in ASPLOS 2013\egroup

#+BEGIN_QUOTE
\footnotesize\textsc{Stabilizer} forces executions to sample the space of memory
configurations by *repeatedly rerandomizing* layouts of code, stack, and
heap objects at runtime. [..] Re-randomization ensures that layout
effects *follow a Gaussian distribution*, enabling the use of
statistical tests like ANOVA.
#+END_QUOTE

\pause\vspace{-.5em}
_Randomization_ helps fighting bias incured by:\vspace{-.5em}
1. specific configurations 
   #+LaTeX: \hspace{.6cm}\scalebox{.85}{$AA \dots A \,\to\, A_1 A_2 \dots A_n$ (\sout{pseudo-replication})}
2. temporary perturbations
   #+LaTeX: \hspace{.25cm}\scalebox{.85}{$AA \dots A\,BB \dots B  \,\to\, ABBAAAB\dots$}
** Impact of Working Set Size on Effective Bandwdith
#+LaTeX: \vspace{.3cm}

#+LaTeX: \hbox{\hspace{-.05\linewidth}\begin{minipage}{1.1\linewidth}
- Cache hierarchy (L1, L2, L3, RAM) with different bandwidth
- LRU, pre-fetching for linear access
- An array fits in a cache level $\Rightarrow$ operate at the
  corresponding bandwidth
- Stride access decrease bandwidth
#+LaTeX: \end{minipage}}\bigskip\pause

#+BEGIN_EXPORT LaTeX
\begin{columns}
  \begin{column}{.5\linewidth}
    \begin{overlayarea}{\linewidth}{4cm}
      \only<2>{\fbox{\includegraphics[width=\linewidth,height=.625\linewidth]{images/randomization/reppar16/MultiMAPSplot5.png}}
      
        \mbox{\small MultiMAPS on an Opteron}\\ \bf\scriptsize
        \textit{Genetic Algorithms Approach to Modeling the
          Performance of Memory-bound Computations}, Tikir et. al. in
        SC'07}%
      \only<3-4>{
        \includegraphics<3>[width=1.05\linewidth,height=.64\linewidth]{images/randomization/reppar16/Rugly.pdf}%
        \includegraphics<4>[width=1.05\linewidth,height=.64\linewidth]{images/randomization/reppar16/Rugly2.pdf}\\
        \only<3-4>{\mbox{\small Our first attempt on a Pentium 4...}}%
      }
    \end{overlayarea}
  \end{column}
  \begin{column}{.55\linewidth}\vspace{-2em}
#+END_EXPORT
  #+BEGIN_SRC python
MultiMAPS(size, stride, nloops) {
  allocate buffer[size]; 
  timer_start();
  for rep in (1..nloops) 
    for i in (0..size/stride) 
       access buffer[stride*i];
  timer_stop();
  bandwidth = nb_access /
              elapsed_time;
  deallocate buffer;
}
  #+END_SRC
#+BEGIN_EXPORT latex
  \end{column}
\end{columns}
#+END_EXPORT
** Impact of Architecture @@latex:\only<3>{(the ARM associativity issue)}@@
#+BEGIN_EXPORT latex
\begin{center}
  \includegraphics<+>[width=.8\linewidth]{images/randomization/reppar16/RphyMem_single.pdf}%
  \includegraphics<+>[width=.8\linewidth]{images/randomization/reppar16/RphyMem.pdf}%
  \includegraphics<+>[width=.8\linewidth]{images/randomization/reppar16/RphyMem2.pdf}
\end{center}
\uncover<.>{Randomize \textbf{physical address} start!}
#+END_EXPORT

#+LaTeX: \vfill\begin{flushright}\scriptsize Courtesy of L. Stanisic\end{flushright}
** Impact of Operating System Scheduler
- Activating \textbf{real-time kernel scheduler}
#+BEGIN_EXPORT latex
 \begin{center}
    \includegraphics[width=.49\linewidth]{images/randomization/reppar16/Sched1.png}
    \hfill
    \uncover<2>{\includegraphics[width=.49\linewidth]{images/randomization/reppar16/Sched2.png}}
 \end{center} 
#+END_EXPORT

#+LaTeX: \vspace{2.4cm}\begin{flushright}\scriptsize Courtesy of L. Stanisic\end{flushright}
** Impact of @@latex: \only<1>{Repetitions}\only<2>{\sout{Repetitions} DVFS}@@
- Remember =nloops= ?
#+BEGIN_EXPORT latex
\begin{center}
  \includegraphics[width=.8\linewidth]{images/randomization/reppar16/Freq.png}
\end{center}
#+END_EXPORT

#+LaTeX: \vspace{-.1cm}\begin{flushright}\scriptsize Courtesy of L. Stanisic\end{flushright}
** MPI Performance Characterization: The many biases
#+LaTeX: \null\vspace{-1.5em}\small
- Powers of two for message sizes ? Linear ?
- Sensitivity to temporal perturbations \bgroup\scriptsize(in order =N_rep=)\egroup
- Breakpoint detection \bgroup\scriptsize(increasing message size, minimal range length, \dots)\egroup
- Outlier removal \bgroup\scriptsize(assumes normality, ignores uncertainty of previous measurements)\egroup

_Measurement proposal:_ \vspace{-.5em}
- Ping-Pong =data_size=
  #+LaTeX: $= 10^X, \text{ where } X \sim \mathrm{Unif}(\log_{10}(a), \log_{10}(b)).$
- Record the time taken in every =MPI_Send= and =MPI_Receive= operation\vspace{-.5em}

_Analysis proposal:_
#+LaTeX: \null\vspace{-.5em}\begin{multicols}{2}
- Manually provided breakpoints
- Regression in R 
#+LaTeX: \end{multicols}\null\vspace{-3.2em}
- Inspect regression output and hypothesis (linearity, noise, "outliers")

#+BEGIN_EXPORT latex
\centerline{\includegraphics[width=.8\linewidth]{images/randomization/reppar16/taurus_send_recv.png}}
Randomized measurements for Taurus (OpenMPI 2.0.1, TCP, 10Gb Ethernet).
#+END_EXPORT
** MPI Measurement: Randomization in action (Stampede@TACC)
#+BEGIN_EXPORT latex
\begin{overlayarea}{\linewidth}{7cm}
  \begin{center}
    \includegraphics<+>[height=6cm]{images/randomization/reppar16/stampede_send_recv_eth.png}
    \includegraphics<+>[height=6cm]{images/randomization/reppar16/stampede_recv_time.png}
    \includegraphics<+>[height=6cm]{images/randomization/reppar16/stampede_recv_time2.png}
    \includegraphics<+->[height=6cm]{images/randomization/reppar16/stampede_send_recv_local.png}

    \only<3>{c558-[203,304]} \only<+>{Even the simpler physical
      quantities can be very tricky to measure because our models and
      protocols are often naive}
  \end{center}
\end{overlayarea}
#+END_EXPORT
** Avoiding "Temporary" Perturbations \footnotesize (Randomizing a Factorial Design)
#+BEGIN_EXPORT latex
\hspace{-.5cm}\alert{$\cdot$} HPL performance (32 nodes, 70 cfg., 5 repetitions)\hfill
\alert{$\cdot$} Time scale = 3 days\vspace{-.4cm}
#+END_EXPORT

#+BEGIN_EXPORT latex
\null\hspace{-.4cm}\begin{minipage}{1.0\linewidth}
  \uncover<1->{\includegraphics[width=.55\linewidth]{images/randomization/tom_hpl_random_perf.png}}%
  \uncover<3->{\includegraphics[width=.55\linewidth]{images/randomization/tom_hpl_random_temp3.png}}

  \uncover<2->{\includegraphics[width=.55\linewidth]{images/randomization/tom_hpl_random_temp1.png}}%
  \uncover<2->{%
     \includegraphics<2>[width=.55\linewidth]{images/randomization/tom_hpl_random_temp2.png}%
     \includegraphics<3>[width=.55\linewidth]{images/randomization/tom_hpl_random_temp2bis.png}%
     }
\end{minipage}
\begin{flushright}\scriptsize Courtesy of T. Cornebize\end{flushright}
#+END_EXPORT
** On the Importance of Content Initialization
#+BEGIN_EXPORT latex
\alert{$\cdot$} $C = A\times A$ ($2048\times2048$), independant \hfill
\alert{$\cdot$} Time scale = 5 minutes\\
\alert{$\cdot$} $A$ initialized with $\boxed{\vphantom{,}0} \quad \boxed{\vphantom{,}1} \quad \boxed{\vphantom{,}0.987} \quad \boxed{1, 2, 3, \dots} \quad \boxed{\vphantom{,}random}$?
\pause\vspace{-.4cm}
#+END_EXPORT
#+BEGIN_EXPORT latex
\null\begin{overlayarea}{1.0\linewidth}{6.6cm}
\includegraphics<+>[width=\linewidth]{images/randomization/tom_dgemm_random_init1.png}%
\includegraphics<+>[width=\linewidth]{images/randomization/tom_dgemm_random_init1.png}%
\includegraphics<+>[width=\linewidth]{images/randomization/tom_dgemm_random_init2.png}%
\includegraphics<+>[width=\linewidth]{images/randomization/tom_dgemm_random_init3.png}%
\includegraphics<+>[width=\linewidth]{images/randomization/tom_dgemm_random_init4.png}%
\includegraphics<+->[width=\linewidth]{images/randomization/tom_dgemm_random_init5.png}%
\end{overlayarea}
\begin{flushright}\scriptsize Courtesy of T. Cornebize\end{flushright}
\begin{overlayarea}{\linewidth}{0cm}
  \only<3>{\vspace{-6cm}\hbox{\hspace{-.4cm}\rotatebox{10}{\fboxsep=0pt
    \fbox{\colorbox{lightgray}{\bf Bit-flips $\Rightarrow$ NRJ Consumption $\Rightarrow$ T°$\uparrow$ + TDP $\Rightarrow$ Frequency $\Rightarrow$ Performance ?!?}}}}
    }
\end{overlayarea}\vspace{-.7cm}
#+END_EXPORT
* What Will it Take ?
** Changing Research Practices
#+LaTeX: \hbox{\bf\normalsize \uline{Soft. Engineering}, \uline{Statistics}, and Reproducible Research in the \alert{curricula}}
\bigskip
# #+LaTeX: \begin{columns}\begin{column}{.5\linewidth}
# file:images/mooc_rr.png
# #+LaTeX: \end{column}\hspace{-.1\linewidth}\begin{column}{.6\linewidth}\vspace{-.8em}
# # - [[https://rr-france.github.io/bookrr/][Webinars on RR]] 2016-2017
# - [[https://rr-france.github.io/bookrr/][Book on RR]]
#   \bgroup\footnotesize /Vers une recherche reproductible: Faire évoluer ses pratiques/\egroup
# - [[https://learninglab.inria.fr/en/mooc-recherche-reproductible-principes-methodologiques-pour-une-science-transparente/][\bf MOOC on RR]] \bgroup\small(3rd edition, ongoing)\egroup
# - A *new "Advanced RR" MOOC* \scalebox{.8}{(2021?)}\footnotesize
#   - \footnotesize Software environment control
#   - \footnotesize Scientific workflow
#   - \footnotesize Managing data
# #+LaTeX: \end{column}\end{columns}

#+begin_export latex
\begin{overlayarea}{\linewidth}{0cm}
\hbox{\hspace{.7\linewidth}\includegraphics[width=.4\linewidth]{images/barba_manifesto.png}}
\end{overlayarea}
#+end_export
*Manifesto*: "\textit{I solemnly pledge}" ([[https://hal.inria.fr/hal-01367344/document][WSSSPE]], [[http://lorenabarba.com/gallery/reproducibility-pi-manifesto/][Lorena Barba]], [[https://www.go-fair.org/fair-principles/][FAIR]])\footnotesize\vspace{-.4em}
  1. I will teach my graduate students about _reproducibility_
  2. All our research code (and writing) is under _version control_
  3. We will always carry out _verification_ and _validation_
  4. We will _share_ data, plotting script & figure _under CC-BY_
  5. We will upload the _preprint_ to arXiv at the time of submission of a paper
  6. We will _release code_ at the time of submission of a paper
  7. We will add a _"Reproducibility" declaration_ at the end of each paper
  8. I will keep an _up-to-date web presence_

\normalsize
*Learn and Teach* using online resources like
- [[https://software-carpentry.org/][Software Carpentry]], [[https://the-turing-way.netlify.app/welcome.html][The Turing Way]], ...
** Changing Publishing Practices
- Artifact evaluation and ACM badges ::  
     #+BEGIN_CENTER
     \includegraphics[height=1cm]{images/ae_badge1.png}
     \includegraphics[height=1cm]{images/ae_badge2.png}
     \includegraphics[height=1cm]{images/acm_badges.pdf}     
     #+END_CENTER
- Major conferences ::  
  - [[https://sc19.supercomputing.org/submit/reproducibility-initiative/][Supercomputing]]: Artifact Description (AD) *mandatory*, Artifact
    Evaluation (AE) still *optional*, *Double blind* vs. *RR*
  - [[https://nips.cc/Conferences/2019/CallForPapers][NeurIPS]], [[https://reproducibility-challenge.github.io/iclr_2019/][ICLR]]: *open reviews*, reproducibility challenge

    [[https://www.youtube.com/watch?v=Kee4ch3miVA][Joelle Pineau @ NeurIPS'18]]
    #+LaTeX: \includegraphics[width=.4\linewidth]{images/joelle_pineau.jpg}
  - [[http://db-reproducibility.seas.harvard.edu/papers/index.html][ACM SIGMOD 2015-2019]], Most Reproducible Paper Award... \medskip
- Mentalitie are evolving :: people care, make stuff available, *errors
     are found and fixed*

** Changing Academic Practices (+Publish or Perish+)
\small
- [[https://thegradient.pub/over-optimization-of-academic-publishing-metrics/][Goodhart’s Law: Are Academic Metrics Being Gamed?]], M. Fire 2019
  - AI: over 1,000 ranked journals ($\times10$ in 15 years)
  - Shorter papers with increasing self references
  - More and more papers without any citation
  - Sharp increase in the number of new authors publishing at a much
    faster rate given their career age
    # - Authors: We noticed a sharp increase in the number of new
    #   authors These new authors are publishing at a much faster rate
    #   given their career age than they have in previous
    #   decades. Additionally, the average number of coauthors per
    #   author considerably increased over time. Lastly, we observed
    #   that in recent years there has been a growing trend for authors
    #   to publish more in conferences.
    # - Papers: We observed that over time, papers became shorter while
    #   other features, such as titles, abstracts, and author lists,
    #   became longer. While the number of references and the number of
    #   self-citations considerably increased, the total number of
    #   papers without any citations grew rapidly as well.
    # - Traditional measures (e.g., number of papers, number of
    #   citations, h-index, and impact factor) have become targets 
    # - Citation number has become a target for some researchers
    # - Exponential growth in the number of new researchers who publish
    #   papers, likely due to career pressures
- [[http://users.cecs.anu.edu.au/~steveb/downloads/pdf/evaluate-toplas-2016.pdf][The Truth, The Whole Truth, and Nothing But the Truth: A Pragmatic]],
  [[http://users.cecs.anu.edu.au/~steveb/downloads/pdf/evaluate-toplas-2016.pdf][Guide to Assessing Empirical Evaluations]], \textit{TOPLAS} 2016
  #+latex: \hfill\begin{columns}\begin{column}{.5\linewidth}
    #+ATTR_LaTeX: :width \linewidth :center nil
    file:images/evaluate-toplas-2016_fig10.pdf
  #+latex: \end{column}\begin{column}{.3\linewidth}\pause
    #+ATTR_LaTeX: :height  2.8cm :center nil
    file:images/ReScience-moto-bordered.pdf
  #+latex: \end{column}\end{columns}
- [[https://www.nature.com/articles/d41586-021-01759-5][Impact factor abandoned by Dutch university in hiring and promotion]],
  [[https://www.nature.com/articles/d41586-021-01759-5][decisions]]. Nature, June 2021. /Faculty and staff members at Utrecht
  University will be evaluated by their commitment to open science/

** What about Open Science ?
[[https://www.ouvrirlascience.fr/][Plan National pour la Science Ouverte]] (BSN $\leadsto$ CoSO)
- [[https://www.science-ouverte.cnrs.fr/][CNRS]], [[https://hal.inria.fr/page/inria-soutient-la-science-ouverte][Inria]], [[https://www.inrae.fr/actualites/inrae-engage-louverture-sciences-societe][INRAE]], ...
- Many flavors: /Citizen Science/

*Main pillars*:\vspace{-.8cm}
#+begin_export latex
\begin{enumerate}
\item Open access \qquad\includegraphics[height=1cm]{images/logo/open-access.png}
\item Open data \qquad\raisebox{-1.8em}{\includegraphics[height=1cm]{images/logo/FAIR_data_principles.jpg}}\vspace{-1em}
\item Open source \hspace{3cm}\raisebox{-1.8em}{\includegraphics[height=1cm]{images/logo/open-source.png}}\vspace{-1.5em}
  \begin{itemize}
  \item \emph{Open hardware}
  \end{itemize}
\item \textbf{Open methodology} (\alert{Reproducible Research})
  \begin{itemize}
  \item \emph{Open-notebook science}
  \item \emph{Open science infrastructures}
  \end{itemize}\vspace{-.8cm}
\item \alert{Open peer review} (avoid \href{https://cacm.acm.org/magazines/2021/6/252840-collusion-rings-threaten-the-integrity-of-computer-science-research/fulltext}{collusion}) \hfill\raisebox{-.8cm}{\includegraphics[height=2cm]{images/logo/open-review.png}}\vspace{-.5cm}
\item Open educational resources \includegraphics[height=1cm]{images/logo/open-educational-resources.png}
\end{enumerate}
#+end_export

** Reproducible Research = Rigor and Transparency                 :noexport:
To err is human. 

#+BEGIN_CENTER
\bf Good research requires time and resources
#+END_CENTER

1. \textbf{Train yourself and your students}: RR, statistics, experiments
   - Beware of checklists and norms
   - Understand what's at stake
2. \textbf{Change the norm:} make publication practices evolve
3. \textbf{Incentive}: consider RR/open science when hiring/promoting\pause
4. \textbf{Prepare the Future:} Toward *literate experimentation*?
   - Reuse, reuse, reuse!
   - Shared and controled testbeds (e.g., Grid'5000/SILECS)
   - How to share Experiments ?

\hfill\mylogo
** Resources and Acknowledgments
*** Book pic                                                        :BMCOL:
:PROPERTIES:
:BEAMER_col: .17
:BEAMER_OPT: t
:END:
#+LaTeX: \fbox{\includegraphics[width=\linewidth,valign=t]{images/book_rr.pdf}}
*** Book                                                            :BMCOL:
:PROPERTIES:
:BEAMER_col: .83
:BEAMER_OPT: t
:END:
  # \vspace{1cm}

  [[https://rr-france.github.io/bookrr/][A non-technical introduction to reproducibility issues]] (in French)
  - Loïc Desquilbet, Sabrina Granger, Boris Hejblum, Pascal Pernot,
    Nicolas Rougier
  \vspace{1cm}
*** squeeze                                               :B_ignoreheading:
:PROPERTIES:
:BEAMER_env: ignoreheading
:END:
\vspace{2mm}\pause
*** MOOC                                                            :BMCOL:
:PROPERTIES:
:BEAMER_col: .72
:BEAMER_OPT: t
:END:
\alert{MOOC} [[https://learninglab.inria.fr/en/mooc-recherche-reproductible-principes-methodologiques-pour-une-science-transparente/][Reproducible Research: Methodological]] [[https://learninglab.inria.fr/en/mooc-recherche-reproductible-principes-methodologiques-pour-une-science-transparente/][principles for a
transparent science]], Learning Lab Inria
- Konrad Hinsen, Christophe Pouzat
- *3rd Edition*: March 2020 -- _March 2022_
- *MOOC RR "Advanced"* planned for +2021+ 2022
  - \footnotesize Software environment control
  - \footnotesize Scientific workflow
  - \footnotesize Managing data

*** MOOC pic                                                        :BMCOL:
:PROPERTIES:
:BEAMER_col: .35
:BEAMER_OPT: t
:END:
#+LaTeX: \includegraphics[width=\linewidth,valign=t]{images/mooc_rr.png}

*** Links                                                 :B_ignoreheading:
:PROPERTIES:
:BEAMER_env: ignoreheading
:END:
\vspace{-.7cm}

* Emacs Setup                                                      :noexport:
This document has local variables in its postembule, which should
allow Org-mode (9) to work seamlessly without any setup. If you're
uncomfortable using such variables, you can safely ignore them at
startup. Exporting may require that you copy them in your .emacs.

# Local Variables:
# eval: (require 'ox-extra)
# eval: (setq org-latex-tables-centered nil)
# eval: (ox-extras-activate '(ignore-headlines))
# eval: (add-to-list 'org-latex-packages-alist '("" "minted"))
# eval: (setq org-latex-listings 'minted)
# eval: (setq org-latex-minted-options '(("style" "Tango") ("bgcolor" "Moccasin") ("frame" "lines") ("linenos" "false") ("fontsize" "\\footnotesize")))
# eval: (setq org-latex-pdf-process '("lualatex -shell-escape -interaction nonstopmode -output-directory %o %f"))
# End:
